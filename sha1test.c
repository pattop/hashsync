#include "sha1.h"

#include <stdio.h>
#include <string.h>
#include <time.h>

#ifndef min
#define min(a, b) ({ \
	__typeof__(a) _a = (a); \
	__typeof__(b) _b = (b); \
	_a < _b ? _a : _b; \
})
#endif

struct testcase {
	uint32_t answer[5];
	const char *msg;
};

#define TESTCASE(a,b,c,d,e,msg) {{UINT32_C(a),UINT32_C(b),UINT32_C(c),UINT32_C(d),UINT32_C(e)}, msg}

static struct testcase testCases[] = {
	TESTCASE(0xDA39A3EE,0x5E6B4B0D,0x3255BFEF,0x95601890,0xAFD80709, ""),
	TESTCASE(0x86F7E437,0xFAA5A7FC,0xE15D1DDC,0xB9EAEAEA,0x377667B8, "a"),
	TESTCASE(0xA9993E36,0x4706816A,0xBA3E2571,0x7850C26C,0x9CD0D89D, "abc"),
	TESTCASE(0xC12252CE,0xDA8BE899,0x4D5FA029,0x0A47231C,0x1D16AAE3, "message digest"),
	TESTCASE(0x32D10C7B,0x8CF96570,0xCA04CE37,0xF2A19D84,0x240D3A89, "abcdefghijklmnopqrstuvwxyz"),
	TESTCASE(0x84983E44,0x1C3BD26E,0xBAAE4AA1,0xF95129E5,0xE54670F1, "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq"),
	TESTCASE(0x0e6e798c,0xf5fc77c6,0xdcfde72d,0xe35b7cf8,0xa09c8356, "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AAAAAAAAAAAAAAAAAAAAAAMAFAAQIGAAAAAAAAAAAAAAAAAAAAAAAAMAFQAYIGAAAAAAAAAAAAAAAAAAAAAAAAMAFgDoIWAAAAAAAAAAAAAAAAAAAAAAAAMAFwDwIWAAAAAAAAAAAAAAAAAAAAAAAAMAGACAImAAAAAAAAAAAAAAAAAAAAAAAAMAGQCAI2AAAAAAAAAAAAAAAAAAAAAAAAMAGgAAAAAAAAAAAAAAAAAAAAAAAQAAAAQA8f8AAAAAAAAAAAAAAAAAAAAACAAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAEwAAAAEAFAAQIGAAAAAAAAAAAAAAAAAAIAAAAAIADQDwB0AAAAAAAAAAAAAAAAAANQAAAAIADQAwCEAAAAAAAAAAAAAAAAAASAAAAAIADQBwCEAAAAAAAAAAAAAAAAAAXgAAAAEAGQCAI2AAAAAAAAEAAAAAAAAAbQAAAAEAEwAIIGAAAAAAAAAAAAAAAAAAlAAAAAIADQCQCEAAAAAAAAAAAAAAAAAAoAAAAAEAEgAAIGAAAAAAAAAAAAAAAAAAvwAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAxgAAAAQA8f8AAAAAAAAAAAAAAAAAAAAA0QAAAAEAGADAImAAAAAAAMAAAAAAAAAACAAAAAQA8f8AAAAAAAAAAAAAAAAAAAAA2wAAAAEAEQDoHUAAAAAAAAAAAAAAAAAA6QAAAAEAFAAQIGAAAAAAAAAAAAAAAAAAAAAAAAQA8f8AAAAAAAAAAAAAAAAAAAAA9QAAAAAAEgAIIGAAAAAAAAAAAAAAAAAABgEAAAEAFQAYIGAAAAAAAAAAAAAAAAAADwEAAAAAEgAAIGAAAAAAAAAAAAAAAAAAIgEAAAEAFwDwIWAAAAAAAAAAAAAAAAAAOAEAABIADQDgGkAAAAAAAAIAAAAAAAAASAEAABIAAAAAAAAAAAAAAAAAAAAAAAAAXQEAACAAAAAAAAAAAAAAAAAAAAAAAAAAeQEAACAAGACAImAAAAAAAAAAAAAAAAAAhAEAABIAAAAAAAAAAAAAAAAAAAAAAAAAlgEAABAAGACAI2AAAAAAAAAAAAAAAAAAnQEAABIAAAAAAAAAAAAAAAAAAAAAAAAAsAEAABIADgDkGkAAAAAAAAAAAAAAAAAAtgEAABIAAAAAAAAAAAAAAAAAAAAAAAAA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BQAAAAAAAAACAAAAAAAAAAIAAAAAAAAAawAAAP7//28CAAAAAAAAABgEQAAAAAAAGAQAAAAAAAAwAAAAAAAAAAYAAAABAAAACAAAAAAAAAAAAAAAAAAAAHoAAAAEAAAAAgAAAAAAAABIBEAAAAAAAEgEAAAAAAAAGAAAAAAAAAAFAAAAAAAAAAgAAAAAAAAAGAAAAAAAAACEAAAABAAAAEIAAAAAAAAAYARAAAAAAABgBAAAAAAAAPAAAAAAAAAABQAAAAwAAAAIAAAAAAAAABgAAAAAAAAAjgAAAAEAAAAGAAAAAAAAAFAFQAAAAAAAUAUAAAAAAAAaAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAIkAAAABAAAABgAAAAAAAABwBUAAAAAAAHAFAAAAAAAAsAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAACUAAAAAQAAAAYAAAAAAAAAIAZAAAAAAAAgBgAAAAAAAMIUAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAmgAAAAEAAAAGAAAAAAAAAOQaQAAAAAAA5BoAAAAAAAAJAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAKAAAAABAAAAAgAAAAAAAADwGkAAAAAAAPAaAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAACoAAAAAQAAAAIAAAAAAAAA0BtAAAAAAADQGwAAAAAAAEwAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAtgAAAAEAAAACAAAAAAAAACAcQAAAAAAAIBwAAAAAAADMAQAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAMAAAAAOAAAAAwAAAAAAAAAAIGAAAAAAAAAgAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAADMAAAADwAAAAMAAAAAAAAACCBgAAAAAAAIIAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAA2AAAAAEAAAADAAAAAAAAABAgYAAAAAAAECAAAAAAAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAN0AAAAGAAAAAwAAAAAAAAAYIGAAAAAAABggAAAAAAAA0AEAAAAAAAAGAAAAAAAAAAgAAAAAAAAAEAAAAAAAAADmAAAAAQAAAAMAAAAAAAAA6CFgAAAAAADoIQAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAA6wAAAAEAAAADAAAAAAAAAPAhYAAAAAAA8CEAAAAAAABoAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAPQAAAABAAAAAwAAAAAAAACAImAAAAAAAIAiAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAD6AAAACAAAAAMAAAAAAAAAgCNgAAAAAACAIwAAAAAAAAgAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA/wAAAAEAAAAwAAAAAAAAAAAAAAAAAAAAgCMAAAAAAABOAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAABEAAAADAAAAAAAAAAAAAAAAAAAAAAAAAM4jAAAAAAAACAEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAAAAAAAAAADYJAAAAAAAAGgHAAAAAAAAHQAAADAAAAAIAAAAAAAAABgAAAAAAAAACQAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAQCwAAAAAAAAPAwAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA=="),
};

static int self_test(void)
{
	int res = 0;
	for (unsigned i = 0; i < sizeof(testCases) / sizeof(testCases[i]); ++i) {
		for (unsigned b = 1; b <= 4096; ++b) {
			uint32_t hash[5];
			struct testcase *tc = &testCases[i];

			sha1_state s;
			sha1_start(&s);
			const size_t len = strlen(tc->msg);
			for (size_t it = 0; it < len; it += b)
				sha1_process(&s, tc->msg + it, min(b, len - it));
			sha1_finish(&s, hash);

			if (memcmp(hash, tc->answer, sizeof(tc->answer)) != 0) {
				printf("Test %d:%d failed!\n", i, b);
				res = -1;
			}
		}
	}
	return res;
}

int main(int argc, char **argv) {
	if (self_test()) {
		printf("Self test failed\n");
		return 1;
	}
	printf("Self test passed\n");

	// Benchmark speed
	uint32_t state[5] = {};
	uint32_t block[16] = {};
	const int N = 10000000;
	clock_t start_time = clock();
	int i;
	for (i = 0; i < N; i++)
		sha1_compress(state, (uint8_t *)block);  // Type-punning
	printf("Speed: %.1f MiB/s\n", (double)N * sizeof(block) / (clock() - start_time) * CLOCKS_PER_SEC / 1048576);

	return 0;
}

